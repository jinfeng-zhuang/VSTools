#########################################################################
# Source & Target
#########################################################################

TARGET = shareinfo

OBJS   = shareinfo.o				\
	 mem_map.o				\
	 pman.o					\
	 Trid_Util_CPUComm_Init.o		\
	 Trid_Util_CRC32.o			\
	 cpu_comm_is_ready.o			\
	 Trid_Util_CPUComm_CreatShareInfo.o	\
	 Trid_Util_CPUComm_CreatSingleInfo.o	\
	 g_comm_fd.o				\
	 CPU_COMM_GET_MEM_MAP_INFO.o		\
	 hexdump.o

#########################################################################
# Toolchain
#########################################################################

export PATH := /opt/p111/armv7a/bin:/opt/cross-arm/linaro-64/bin:$(PATH)

CC      = armv7a-cros-linux-gnueabi-gcc
CFLAGS  = -I./include -I ~/API/include
LDFLAGS = -lpthread

#########################################################################
# Rule
#########################################################################

.PHONY:all 
.PHONY:clean 

all : $(TARGET)

$(TARGET): $(OBJS)
	$(CC) -o $@ $^ $(LDFLAGS)

%.o:%.c
	$(CC) -o $@ -c $< $(CFLAGS)

%.d:%.c
	@set -e; rm -f $@; $(CC) -MM $< > $@.$$$$; \
	sed 's,\($*\)\.o[ :]*,\1.o $@ : ,g' < $@.$$$$ > $@; \
	rm -f $@.$$$$

-include $(OBJS:.o=.d)

clean:
	rm -f $(TARGETS) *.o *.d *.d.*

